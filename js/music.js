class ScoMusicPlayer{constructor(){this.init()}init(){document.documentElement.style.setProperty("--vh",window.innerHeight+"px"),this.getCustomPlayList(),this.addEventListenerToDocument(),this.addButtonListEventListener()}getCustomPlayList(){this.changeMusicBg(!1)}addEventListenerToDocument(){document.addEventListener("keydown",this.handleKeydown.bind(this))}addButtonListEventListener(){let e=document.querySelector(".aplayer-list");document.querySelector(".aplayer-lrc")?.addEventListener("click",()=>{e.classList.toggle("aplayer-list-hide")})}changeMusicBg(e=!0){var t=document.getElementById("Music-bg"),a=document.getElementsByClassName("Music-loading")[0];e?this.updateBackgroundImage(t):this.setLoadingScreen(a,t)}updateBackgroundImage(e){let t=document.querySelector("#Music-page .aplayer-pic"),a=new Image;a.src=this.extractValue(t.style.backgroundImage),a.onload=()=>{e.style.backgroundImage=t.style.backgroundImage},e.className="show"}setLoadingScreen(e,t){let a=setInterval(()=>{document.querySelector("#Music-page .aplayer-pic")&&(e.style.display="none",clearInterval(a),document.querySelector("meting-js"),this.addEventListenerChangeMusicBg(),t.style.display="block"),this.addButtonListEventListener()},100)}extractValue(e){e=/url\("([^"]+)"\)/.exec(e);return e?e[1]:""}addEventListenerChangeMusicBg(){var e=document.querySelector("#Music-page meting-js").aplayer;e.on("loadeddata",this.changeMusicBg.bind(this,!0)),e.on("timeupdate",this.lrcUpdate.bind(this))}lrcUpdate(){var e=document.querySelector(".aplayer-lrc-contents"),t=e.querySelector("p.aplayer-lrc-current");t&&(t=Array.from(e.children).indexOf(t),e.style.transform=`translateY(${80*-t}px)`)}handleKeydown(e){var t=document.querySelector("meting-js").aplayer;switch(e.code){case"Space":e.preventDefault(),t.toggle();break;case"ArrowRight":e.preventDefault(),t.skipForward();break;case"ArrowLeft":e.preventDefault(),t.skipBack();break;case"ArrowUp":e.preventDefault(),t.volume<1&&t.volume(t.volume+.1);break;case"ArrowDown":e.preventDefault(),0<t.volume&&t.volume(t.volume-.1)}}destroy(){document.removeEventListener("keydown",this.handleKeydown)}}function initializeMusicPlayer(){var e=window.scoMusic;e&&e.destroy(),window.scoMusic=new ScoMusicPlayer}